@if (ViewData.ModelState.ContainsKey("LessonVideo") && ViewData.ModelState["LessonVideo"] != null && ViewData.ModelState["LessonVideo"].Errors.Count > 0)
{
    <div class="text-danger">
        @ViewData.ModelState["LessonVideo"].Errors[0].ErrorMessage
    </div>
}
@if (ViewData.ModelState.ContainsKey("LessonVideo")
  && ViewData.ModelState["LessonVideo"] != null
  && ViewData.ModelState["LessonVideo"].Errors != null
  && ViewData.ModelState["LessonVideo"].Errors.Count > 0)
{
    <div class="text-danger">
        @ViewData.ModelState["LessonVideo"].Errors[0].ErrorMessage
    </div>
}

@model BrainStormEra.Models.Lesson
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BrainStormEra</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
    <link rel="stylesheet" href="~/css/Lesson/AddLesson.css" />
    <link rel="stylesheet" href="~/css/base.css" />
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet" />
</head>

<body>
    <div class="d-flex flex-column flex-md-row">
        <div class="sidebar">
            <button class="btn btn-primary"
                    id="add-lesson-btn"
                    onclick="switchToAddLesson()">
                Add Lesson
            </button>
            <button class="btn btn-outline-secondary"
                    id="delete-lesson-btn"
                    onclick="switchToDeleteLesson()">
                Delete Lesson
            </button>
            <button class="btn btn-outline-secondary"
                    asp-controller="Lesson"
                    asp-action="ViewLesson"
                    asp-route-lessonId="@Model.LessonId"
                    id="view-lesson-btn"
                    onclick="switchToViewLesson()">
                View Lesson
            </button>
        </div>
        <div class="content flex-grow-1">
            <div class="content-header" id="content-header">
                <h5>MANAGE LESSONS FOR CHAPTER 1</h5>
            </div>
            <form id="lesson-form" action="/Lesson/CreateLesson"
                  method="post"
                  enctype="multipart/form-data">
                @Html.AntiForgeryToken()
                <!-- Lesson ID -->
                <div class="mb-3">
                    <label for="lessonId" class="form-label">Lesson ID</label>
                    <input type="text"
                           asp-for="LessonId"
                           class="form-control"
                           id="lessonId"
                           name="LessonId"
                           placeholder="Enter Lesson ID"
                           required />
                </div>

                <!-- Chapter ID -->
                <div class="mb-3">
                    <label for="chapterId" class="form-label">Chapter ID</label>
                    <input type="text"
                           asp-for="ChapterId"
                           class="form-control"
                           id="chapterId"
                           name="ChapterId"
                           placeholder="Enter Chapter ID"
                           required />
                </div>

                <!-- Lesson Name -->
                <div class="mb-3">
                    <label for="lessonTitle" class="form-label">Lesson Name</label>
                    <input type="text"
                           asp-for="LessonName"
                           class="form-control"
                           id="LessonTitle"
                           name="LessonName"
                           placeholder="Enter Lesson Name"
                           required />
                </div>

                <!-- Lesson Description -->
                <div class="mb-3">
                    <label for="lessonDescription" class="form-label">Lesson Description</label>
                    <textarea class="form-control"
                              asp-for="LessonDescription"
                              id="lessonDescription"
                              name="LessonDescription"
                              rows="3"
                              placeholder="Enter Lesson Description"></textarea>
                </div>

                <!-- Lesson Order -->
                <div class="mb-3">
                    <label for="lessonOrder" class="form-label">Lesson Order</label>
                    <input min="0" type="number"
                           class="form-control"
                           asp-for="LessonOrder"
                           id="lessonOrder"
                           name="LessonOrder"
                           placeholder="Enter Lesson Order"
                           required />
                </div>

                <!-- Lesson Type (Dropdown) -->
                <div class="mb-3">
                    <label for="lessonType" class="form-label">Lesson Type</label>
                    <select class="form-select"
                            asp-for="LessonTypeId"
                            id="lessonType"
                            name="LessonTypeId"
                            onchange="toggleLessonType()">
                        <option value="">Select Lesson Type</option>
                        <option value="1">Video</option>
                        <option value="2">Reading</option>
                    </select>
                </div>

                <!-- Lesson Status (Dropdown) -->
                <div class="mb-3">
                    <label for="lessonStatus" class="form-label">Lesson Status</label>
                    <select class="form-select" id="lessonStatus" name="LessonStatus" asp-for="LessonStatus">
                        <option value="">Select Lesson Status</option>
                        <option value="1">Inactive</option>
                        <option value="2">Active</option>
                    </select>
                </div>

                <!-- Lesson Date -->
                <div class="mb-3">
                    <label for="lessonDate" class="form-label">Lesson Date</label>
                    <input type="date"
                           class="form-control"
                           asp-for="LessonCreatedAt"
                           id="lessonDate"
                           name="LessonDate"
                           required />
                </div>

                <!-- Video section -->
                <div class="mb-3">
                    <button type="button"
                            id="createVideoBtn"
                            class="btn btn-outline-secondary"
                            onclick="toggleSection('videoSection')">
                        Create Video
                    </button>
                    <div id="videoSection" class="toggle-section" style="display:none;">
                        <!-- Button to trigger file selection -->
                        <button type="button"
                                class="btn btn-primary"
                                data-bs-toggle="modal"
                                data-bs-target="#uploadModal">
                            Upload Video
                        </button>
                    </div>

                    <!-- Upload Modal -->
                    <div>
                        <div class="modal fade"
                             id="uploadModal"
                             tabindex="-1"
                             aria-labelledby="uploadModalLabel"
                             aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="uploadModalLabel">
                                            SUBMISSION
                                        </h5>
                                        <button type="button"
                                                class="btn-close"
                                                data-bs-dismiss="modal"
                                                aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <h6>Upload File</h6>
                                        <!-- Video Section -->
                                        <label for="fileInput"
                                               class="btn-file-label"
                                               id="chooseFileLabel">Choose File</label>
                                        <input type="file" name="LessonVideo" id="fileInput" accept="video/*" />
                                        <div id="fileDetails" class="file-details"></div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button"
                                                class="btn btn-secondary"
                                                data-bs-dismiss="modal">
                                            Close
                                        </button>
                                        <button type="button"
                                                class="btn btn-primary"
                                                data-bs-dismiss="modal"
                                                onclick="submitForm()">
                                            Submit
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Custom Notification Alert -->
                        <div id="customNotification"
                             class="alert custom-notification alert-success"
                             role="alert">
                            File uploaded successfully!
                        </div>
                    </div>
                    <!-- Display uploaded video name -->
                    <div id="uploadedFileName" font-weight: light;"></div>
                </div>
                <div class="mb-3">
                    <button type="button"
                            id="createReadingBtn"
                            class="btn btn-outline-secondary"
                            onclick="toggleSection('readingSection')">
                        Create Reading
                    </button>

                    <div id="readingSection" class="toggle-section">
                        <label for="description" class="form-label">Description</label>
                        <div id="editor-container">
                            <div id="toolbar-container">
                                <select class="ql-header">
                                    <option value="1">Heading 1</option>
                                    <option value="2">Heading 2</option>
                                    <option value="3">Heading 3</option>
                                    <option value="" selected>Normal</option>
                                </select>
                                <button class="ql-bold"></button>
                                <button class="ql-italic"></button>
                                <button class="ql-underline"></button>
                                <button class="ql-strike"></button>
                                <button class="ql-link"></button>
                                <button class="ql-list" value="bullet"></button>
                                <button class="ql-list" value="ordered"></button>
                            </div>
                            <!-- Quill editor -->
                            <div id="editor" class="editor"></div>
                            <!-- Hidden field to store the content -->
                            <input type="hidden" id="lessonContent" name="LessonContent" />
                        </div>
                    </div>
                </div>
                <button type="submit" class="btn-create">Create</button>
            </form>

            <!-- External Scripts -->
            <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.11.8/umd/popper.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
            <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

            <script src="~/js/Lesson/Lesson.js"></script>
        </div>
    </div>
</body>
</html>
